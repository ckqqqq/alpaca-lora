
CommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.



CommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.


# conda environments:
#
base                     /home/ckq/anaconda3
accel                 *  /home/ckq/anaconda3/envs/accel
deeps                    /home/ckq/anaconda3/envs/deeps
py38                     /home/ckq/anaconda3/envs/py38
py39                     /home/ckq/anaconda3/envs/py39
wyx                      /home/ckq/anaconda3/envs/wyx

[2023-04-21 10:45:55,852] [WARNING] [runner.py:190:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
Detected CUDA_VISIBLE_DEVICES=1,2,3,4,5,6: setting --include=localhost:1,2,3,4,5,6
[2023-04-21 10:45:55,916] [INFO] [runner.py:540:main] cmd = /home/ckq/anaconda3/envs/accel/bin/python3.9 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMSwgMiwgMywgNCwgNSwgNl19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None finetune.py --base_model /home/ckq/CHATGPT/0model_pretrained/llama-7b-hf --data_path yahma/alpaca-cleaned --output_dir ./lora-alpaca --batch_size 32 --micro_batch_size 8 --num_epochs 2 --learning_rate 3e-4 --cutoff_len 1024 --val_set_size 2000 --lora_r 8 --lora_alpha 16 --lora_dropout 0.05 --lora_target_modules [q_proj,v_proj] --train_on_inputs --resume_from_checkpoint  --deepspeed_path /home/ckq/CHATGPT/alpaca-lora/config/6_gpu_ft.yaml --group_by_length --wandb_project llama-lora
[2023-04-21 10:45:57,726] [INFO] [launch.py:229:main] WORLD INFO DICT: {'localhost': [1, 2, 3, 4, 5, 6]}
[2023-04-21 10:45:57,726] [INFO] [launch.py:235:main] nnodes=1, num_local_procs=6, node_rank=0
[2023-04-21 10:45:57,726] [INFO] [launch.py:246:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5]})
[2023-04-21 10:45:57,726] [INFO] [launch.py:247:main] dist_world_size=6
[2023-04-21 10:45:57,726] [INFO] [launch.py:249:main] Setting CUDA_VISIBLE_DEVICES=1,2,3,4,5,6

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/cuda_setup/main.py:145: UserWarning: /home/ckq/anaconda3/envs/accel did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.7/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/cuda_setup/main.py:145: UserWarning: /home/ckq/anaconda3/envs/accel did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.7/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/cuda_setup/main.py:145: UserWarning: /home/ckq/anaconda3/envs/accel did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.7/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/cuda_setup/main.py:145: UserWarning: /home/ckq/anaconda3/envs/accel did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.7/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
bin /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/cuda_setup/main.py:145: UserWarning: /home/ckq/anaconda3/envs/accel did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.7/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/cuda_setup/main.py:145: UserWarning: /home/ckq/anaconda3/envs/accel did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.7/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
ddp 4
ddp 4
ddp 4
ddp 4
ddp 4
Loading checkpoint shards:   0%|          | 0/33 [00:00<?, ?it/s]Training Alpaca-LoRA model with params:
base_model: /home/ckq/CHATGPT/0model_pretrained/llama-7b-hf
data_path: yahma/alpaca-cleaned
output_dir: ./lora-alpaca
gradient_accumulation_steps_per_gpu: 4 
micro_batch_size: 8
num_epochs: 2
learning_rate: 0.0003
cutoff_len: 1024
val_set_size: 2000
lora_r: 8
lora_alpha: 16
lora_dropout: 0.05
lora_target_modules: ['q_proj', 'v_proj']
train_on_inputs: True
add_eos_token: False
group_by_length: True
wandb_project: llama-lora
wandb_run_name: 
wandb_watch: 
wandb_log_model: 
resume_from_checkpoint: False ***************** 
prompt template: alpaca
deepspeed: /home/ckq/CHATGPT/alpaca-lora/config/6_gpu_ft.yaml

ddp 4
Loading checkpoint shards:   3%|▎         | 1/33 [00:02<01:34,  2.94s/it]Loading checkpoint shards:   6%|▌         | 2/33 [00:03<00:44,  1.44s/it]Loading checkpoint shards:   9%|▉         | 3/33 [00:03<00:28,  1.07it/s]Loading checkpoint shards:  12%|█▏        | 4/33 [00:04<00:21,  1.34it/s]Loading checkpoint shards:   0%|          | 0/33 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/33 [00:00<?, ?it/s]Loading checkpoint shards:  15%|█▌        | 5/33 [00:04<00:17,  1.63it/s]Loading checkpoint shards:  18%|█▊        | 6/33 [00:04<00:14,  1.89it/s]Loading checkpoint shards:   0%|          | 0/33 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/33 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/33 [00:00<?, ?it/s]Loading checkpoint shards:  21%|██        | 7/33 [00:05<00:12,  2.07it/s]Loading checkpoint shards:  24%|██▍       | 8/33 [00:05<00:11,  2.23it/s]Loading checkpoint shards:  27%|██▋       | 9/33 [00:06<00:10,  2.28it/s]Loading checkpoint shards:   3%|▎         | 1/33 [00:01<00:49,  1.55s/it]Loading checkpoint shards:  30%|███       | 10/33 [00:06<00:09,  2.38it/s]Loading checkpoint shards:   3%|▎         | 1/33 [00:02<01:15,  2.35s/it]Loading checkpoint shards:   6%|▌         | 2/33 [00:01<00:26,  1.17it/s]Loading checkpoint shards:  33%|███▎      | 11/33 [00:06<00:09,  2.41it/s]Loading checkpoint shards:   3%|▎         | 1/33 [00:02<01:20,  2.51s/it]Loading checkpoint shards:   6%|▌         | 2/33 [00:02<00:36,  1.18s/it]Loading checkpoint shards:   3%|▎         | 1/33 [00:02<01:14,  2.31s/it]Loading checkpoint shards:   3%|▎         | 1/33 [00:02<01:14,  2.31s/it]Loading checkpoint shards:   9%|▉         | 3/33 [00:02<00:20,  1.49it/s]Loading checkpoint shards:   6%|▌         | 2/33 [00:02<00:39,  1.26s/it]Loading checkpoint shards:  36%|███▋      | 12/33 [00:07<00:08,  2.38it/s]Loading checkpoint shards:   9%|▉         | 3/33 [00:03<00:24,  1.24it/s]Loading checkpoint shards:   6%|▌         | 2/33 [00:02<00:36,  1.17s/it]Loading checkpoint shards:   6%|▌         | 2/33 [00:02<00:36,  1.17s/it]Loading checkpoint shards:  12%|█▏        | 4/33 [00:02<00:16,  1.80it/s]Loading checkpoint shards:   9%|▉         | 3/33 [00:03<00:25,  1.16it/s]Loading checkpoint shards:  39%|███▉      | 13/33 [00:07<00:08,  2.42it/s]Loading checkpoint shards:  12%|█▏        | 4/33 [00:03<00:18,  1.59it/s]Loading checkpoint shards:   9%|▉         | 3/33 [00:03<00:24,  1.24it/s]Loading checkpoint shards:   9%|▉         | 3/33 [00:03<00:24,  1.24it/s]Loading checkpoint shards:  15%|█▌        | 5/33 [00:03<00:13,  2.05it/s]Loading checkpoint shards:  12%|█▏        | 4/33 [00:03<00:19,  1.49it/s]Loading checkpoint shards:  42%|████▏     | 14/33 [00:08<00:07,  2.50it/s]Loading checkpoint shards:  15%|█▌        | 5/33 [00:03<00:14,  1.87it/s]Loading checkpoint shards:  12%|█▏        | 4/33 [00:03<00:18,  1.58it/s]Loading checkpoint shards:  18%|█▊        | 6/33 [00:03<00:12,  2.24it/s]Loading checkpoint shards:  15%|█▌        | 5/33 [00:04<00:15,  1.77it/s]Loading checkpoint shards:  12%|█▏        | 4/33 [00:03<00:19,  1.52it/s]Loading checkpoint shards:  45%|████▌     | 15/33 [00:08<00:07,  2.46it/s]Loading checkpoint shards:  18%|█▊        | 6/33 [00:04<00:12,  2.08it/s]Loading checkpoint shards:  15%|█▌        | 5/33 [00:03<00:15,  1.86it/s]Loading checkpoint shards:  21%|██        | 7/33 [00:03<00:10,  2.36it/s]Loading checkpoint shards:  18%|█▊        | 6/33 [00:04<00:13,  2.01it/s]Loading checkpoint shards:  15%|█▌        | 5/33 [00:03<00:15,  1.76it/s]Loading checkpoint shards:  48%|████▊     | 16/33 [00:08<00:06,  2.52it/s]Loading checkpoint shards:  21%|██        | 7/33 [00:04<00:11,  2.27it/s]Loading checkpoint shards:  18%|█▊        | 6/33 [00:04<00:12,  2.10it/s]Loading checkpoint shards:  24%|██▍       | 8/33 [00:04<00:10,  2.43it/s]Loading checkpoint shards:  21%|██        | 7/33 [00:04<00:11,  2.20it/s]Loading checkpoint shards:  24%|██▍       | 8/33 [00:04<00:10,  2.43it/s]Loading checkpoint shards:  18%|█▊        | 6/33 [00:04<00:13,  1.93it/s]Loading checkpoint shards:  52%|█████▏    | 17/33 [00:09<00:06,  2.45it/s]Loading checkpoint shards:  21%|██        | 7/33 [00:04<00:11,  2.27it/s]Loading checkpoint shards:  27%|██▋       | 9/33 [00:04<00:09,  2.43it/s]Loading checkpoint shards:  27%|██▋       | 9/33 [00:05<00:09,  2.56it/s]Loading checkpoint shards:  24%|██▍       | 8/33 [00:05<00:11,  2.17it/s]Loading checkpoint shards:  21%|██        | 7/33 [00:04<00:12,  2.12it/s]Loading checkpoint shards:  55%|█████▍    | 18/33 [00:09<00:05,  2.53it/s]Loading checkpoint shards:  24%|██▍       | 8/33 [00:04<00:10,  2.34it/s]Loading checkpoint shards:  30%|███       | 10/33 [00:05<00:08,  2.69it/s]Loading checkpoint shards:  30%|███       | 10/33 [00:05<00:09,  2.45it/s]Loading checkpoint shards:  58%|█████▊    | 19/33 [00:09<00:05,  2.58it/s]Loading checkpoint shards:  27%|██▋       | 9/33 [00:05<00:10,  2.24it/s]Loading checkpoint shards:  24%|██▍       | 8/33 [00:05<00:11,  2.21it/s]Loading checkpoint shards:  27%|██▋       | 9/33 [00:05<00:09,  2.41it/s]Loading checkpoint shards:  33%|███▎      | 11/33 [00:05<00:07,  2.78it/s]Loading checkpoint shards:  33%|███▎      | 11/33 [00:05<00:08,  2.48it/s]Loading checkpoint shards:  61%|██████    | 20/33 [00:10<00:04,  2.66it/s]Loading checkpoint shards:  30%|███       | 10/33 [00:06<00:09,  2.31it/s]Loading checkpoint shards:  27%|██▋       | 9/33 [00:05<00:10,  2.22it/s]Loading checkpoint shards:  36%|███▋      | 12/33 [00:06<00:07,  2.86it/s]Loading checkpoint shards:  30%|███       | 10/33 [00:05<00:09,  2.49it/s]Loading checkpoint shards:  64%|██████▎   | 21/33 [00:10<00:04,  2.71it/s]Loading checkpoint shards:  36%|███▋      | 12/33 [00:05<00:08,  2.50it/s]Loading checkpoint shards:  33%|███▎      | 11/33 [00:06<00:09,  2.36it/s]Loading checkpoint shards:  30%|███       | 10/33 [00:05<00:09,  2.31it/s]Loading checkpoint shards:  39%|███▉      | 13/33 [00:06<00:06,  2.87it/s]Loading checkpoint shards:  33%|███▎      | 11/33 [00:06<00:08,  2.54it/s]Loading checkpoint shards:  67%|██████▋   | 22/33 [00:11<00:03,  2.75it/s]Loading checkpoint shards:  39%|███▉      | 13/33 [00:06<00:07,  2.57it/s]Loading checkpoint shards:  42%|████▏     | 14/33 [00:06<00:06,  2.90it/s]Loading checkpoint shards:  33%|███▎      | 11/33 [00:06<00:09,  2.39it/s]Loading checkpoint shards:  36%|███▋      | 12/33 [00:06<00:09,  2.27it/s]Loading checkpoint shards:  36%|███▋      | 12/33 [00:06<00:08,  2.55it/s]Loading checkpoint shards:  70%|██████▉   | 23/33 [00:11<00:03,  2.76it/s]Loading checkpoint shards:  42%|████▏     | 14/33 [00:06<00:07,  2.63it/s]Loading checkpoint shards:  45%|████▌     | 15/33 [00:07<00:06,  2.87it/s]Loading checkpoint shards:  36%|███▋      | 12/33 [00:06<00:08,  2.39it/s]Loading checkpoint shards:  39%|███▉      | 13/33 [00:06<00:07,  2.62it/s]Loading checkpoint shards:  39%|███▉      | 13/33 [00:07<00:08,  2.31it/s]Loading checkpoint shards:  73%|███████▎  | 24/33 [00:11<00:03,  2.76it/s]Loading checkpoint shards:  45%|████▌     | 15/33 [00:06<00:07,  2.55it/s]Loading checkpoint shards:  48%|████▊     | 16/33 [00:07<00:05,  2.87it/s]Loading checkpoint shards:  42%|████▏     | 14/33 [00:07<00:07,  2.67it/s]Loading checkpoint shards:  39%|███▉      | 13/33 [00:07<00:08,  2.45it/s]Loading checkpoint shards:  42%|████▏     | 14/33 [00:07<00:07,  2.43it/s]Loading checkpoint shards:  76%|███████▌  | 25/33 [00:12<00:02,  2.71it/s]Loading checkpoint shards:  48%|████▊     | 16/33 [00:07<00:06,  2.52it/s]Loading checkpoint shards:  52%|█████▏    | 17/33 [00:07<00:05,  2.89it/s]Loading checkpoint shards:  45%|████▌     | 15/33 [00:07<00:06,  2.69it/s]Loading checkpoint shards:  42%|████▏     | 14/33 [00:07<00:07,  2.54it/s]Loading checkpoint shards:  45%|████▌     | 15/33 [00:08<00:07,  2.52it/s]Loading checkpoint shards:  79%|███████▉  | 26/33 [00:12<00:02,  2.70it/s]Loading checkpoint shards:  55%|█████▍    | 18/33 [00:08<00:05,  2.87it/s]Loading checkpoint shards:  52%|█████▏    | 17/33 [00:07<00:06,  2.51it/s]Loading checkpoint shards:  45%|████▌     | 15/33 [00:07<00:06,  2.60it/s]Loading checkpoint shards:  48%|████▊     | 16/33 [00:07<00:06,  2.67it/s]Loading checkpoint shards:  48%|████▊     | 16/33 [00:08<00:06,  2.55it/s]Loading checkpoint shards:  82%|████████▏ | 27/33 [00:12<00:02,  2.72it/s]Loading checkpoint shards:  58%|█████▊    | 19/33 [00:08<00:04,  2.89it/s]Loading checkpoint shards:  55%|█████▍    | 18/33 [00:08<00:05,  2.51it/s]Loading checkpoint shards:  48%|████▊     | 16/33 [00:08<00:06,  2.61it/s]Loading checkpoint shards:  52%|█████▏    | 17/33 [00:08<00:05,  2.69it/s]Loading checkpoint shards:  52%|█████▏    | 17/33 [00:08<00:06,  2.61it/s]Loading checkpoint shards:  85%|████████▍ | 28/33 [00:13<00:01,  2.73it/s]Loading checkpoint shards:  61%|██████    | 20/33 [00:08<00:04,  2.90it/s]Loading checkpoint shards:  58%|█████▊    | 19/33 [00:08<00:05,  2.51it/s]Loading checkpoint shards:  55%|█████▍    | 18/33 [00:08<00:05,  2.71it/s]Loading checkpoint shards:  52%|█████▏    | 17/33 [00:08<00:06,  2.57it/s]Loading checkpoint shards:  55%|█████▍    | 18/33 [00:09<00:05,  2.59it/s]Loading checkpoint shards:  88%|████████▊ | 29/33 [00:13<00:01,  2.74it/s]Loading checkpoint shards:  64%|██████▎   | 21/33 [00:09<00:04,  2.89it/s]Loading checkpoint shards:  61%|██████    | 20/33 [00:08<00:05,  2.51it/s]Loading checkpoint shards:  58%|█████▊    | 19/33 [00:08<00:05,  2.72it/s]Loading checkpoint shards:  58%|█████▊    | 19/33 [00:09<00:05,  2.64it/s]Loading checkpoint shards:  55%|█████▍    | 18/33 [00:09<00:05,  2.54it/s]Loading checkpoint shards:  67%|██████▋   | 22/33 [00:09<00:03,  2.85it/s]Loading checkpoint shards:  91%|█████████ | 30/33 [00:14<00:01,  2.65it/s]Loading checkpoint shards:  61%|██████    | 20/33 [00:09<00:04,  2.72it/s]Loading checkpoint shards:  64%|██████▎   | 21/33 [00:09<00:04,  2.54it/s]Loading checkpoint shards:  61%|██████    | 20/33 [00:09<00:04,  2.68it/s]Loading checkpoint shards:  58%|█████▊    | 19/33 [00:09<00:05,  2.57it/s]Loading checkpoint shards:  70%|██████▉   | 23/33 [00:10<00:03,  2.82it/s]Loading checkpoint shards:  94%|█████████▍| 31/33 [00:14<00:00,  2.58it/s]Loading checkpoint shards:  64%|██████▎   | 21/33 [00:09<00:04,  2.73it/s]Loading checkpoint shards:  67%|██████▋   | 22/33 [00:09<00:04,  2.57it/s]Loading checkpoint shards:  64%|██████▎   | 21/33 [00:10<00:04,  2.72it/s]Loading checkpoint shards:  61%|██████    | 20/33 [00:09<00:04,  2.61it/s]Loading checkpoint shards:  73%|███████▎  | 24/33 [00:10<00:03,  2.79it/s]Loading checkpoint shards:  97%|█████████▋| 32/33 [00:14<00:00,  2.62it/s]Loading checkpoint shards:  67%|██████▋   | 22/33 [00:10<00:04,  2.74it/s]Loading checkpoint shards:  70%|██████▉   | 23/33 [00:10<00:03,  2.60it/s]Loading checkpoint shards:  67%|██████▋   | 22/33 [00:10<00:04,  2.75it/s]Loading checkpoint shards:  64%|██████▎   | 21/33 [00:10<00:04,  2.62it/s]Loading checkpoint shards:  76%|███████▌  | 25/33 [00:10<00:02,  2.76it/s]Loading checkpoint shards: 100%|██████████| 33/33 [00:15<00:00,  2.52it/s]Loading checkpoint shards: 100%|██████████| 33/33 [00:15<00:00,  2.17it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LLaMATokenizer'. 
The class this function is called from is 'LlamaTokenizer'.
Loading checkpoint shards:  70%|██████▉   | 23/33 [00:10<00:03,  2.75it/s]Loading checkpoint shards:  73%|███████▎  | 24/33 [00:10<00:03,  2.64it/s]Loading checkpoint shards:  70%|██████▉   | 23/33 [00:11<00:03,  2.75it/s]Loading checkpoint shards:  79%|███████▉  | 26/33 [00:11<00:02,  2.80it/s]Loading checkpoint shards:  67%|██████▋   | 22/33 [00:10<00:04,  2.60it/s]Loading checkpoint shards:  73%|███████▎  | 24/33 [00:10<00:03,  2.78it/s]Loading checkpoint shards:  73%|███████▎  | 24/33 [00:11<00:03,  2.77it/s]Loading checkpoint shards:  76%|███████▌  | 25/33 [00:10<00:03,  2.67it/s]Loading checkpoint shards:  82%|████████▏ | 27/33 [00:11<00:02,  2.82it/s]Loading checkpoint shards:  70%|██████▉   | 23/33 [00:10<00:03,  2.63it/s]Loading checkpoint shards:  76%|███████▌  | 25/33 [00:11<00:02,  2.79it/s]Loading checkpoint shards:  76%|███████▌  | 25/33 [00:11<00:02,  2.77it/s]Loading checkpoint shards:  79%|███████▉  | 26/33 [00:11<00:02,  2.66it/s]Loading checkpoint shards:  85%|████████▍ | 28/33 [00:11<00:01,  2.78it/s]Loading checkpoint shards:  73%|███████▎  | 24/33 [00:11<00:03,  2.68it/s]Loading checkpoint shards:  79%|███████▉  | 26/33 [00:11<00:02,  2.81it/s]Loading checkpoint shards:  79%|███████▉  | 26/33 [00:12<00:02,  2.72it/s]Loading checkpoint shards:  82%|████████▏ | 27/33 [00:11<00:02,  2.66it/s]Loading checkpoint shards:  88%|████████▊ | 29/33 [00:12<00:01,  2.79it/s]Loading checkpoint shards:  76%|███████▌  | 25/33 [00:11<00:02,  2.70it/s]Loading checkpoint shards:  82%|████████▏ | 27/33 [00:11<00:02,  2.81it/s]Loading checkpoint shards:  82%|████████▏ | 27/33 [00:11<00:02,  2.27it/s]
Traceback (most recent call last):
  File "/home/ckq/CHATGPT/alpaca-lora/finetune.py", line 293, in <module>
    fire.Fire(train)
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/ckq/CHATGPT/alpaca-lora/finetune.py", line 118, in train
    model = LlamaForCausalLM.from_pretrained(
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/transformers/modeling_utils.py", line 2795, in from_pretrained
    ) = cls._load_pretrained_model(
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/transformers/modeling_utils.py", line 3123, in _load_pretrained_model
    new_error_msgs, offload_index, state_dict_index = _load_state_dict_into_meta_model(
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/transformers/modeling_utils.py", line 706, in _load_state_dict_into_meta_model
    set_module_8bit_tensor_to_device(
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/transformers/utils/bitsandbytes.py", line 78, in set_module_8bit_tensor_to_device
    new_value = bnb.nn.Int8Params(new_value, requires_grad=False, has_fp16_weights=has_fp16_weights).to(device)
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/nn/modules.py", line 227, in to
    return self.cuda(device)
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/nn/modules.py", line 191, in cuda
    CB, CBt, SCB, SCBt, coo_tensorB = bnb.functional.double_quant(B)
  File "/home/ckq/anaconda3/envs/accel/lib/python3.9/site-packages/bitsandbytes/functional.py", line 1649, in double_quant
    out_row = torch.zeros(A.shape, device=device, dtype=torch.int8)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 44.00 MiB (GPU 0; 23.70 GiB total capacity; 5.36 GiB already allocated; 33.56 MiB free; 5.57 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Loading checkpoint shards:  82%|████████▏ | 27/33 [00:12<00:02,  2.75it/s]Loading checkpoint shards:  91%|█████████ | 30/33 [00:12<00:01,  2.80it/s]Loading checkpoint shards:  79%|███████▉  | 26/33 [00:12<00:02,  2.73it/s]Loading checkpoint shards:  85%|████████▍ | 28/33 [00:12<00:01,  2.83it/s]Loading checkpoint shards:  85%|████████▍ | 28/33 [00:12<00:01,  2.77it/s]Loading checkpoint shards:  94%|█████████▍| 31/33 [00:12<00:00,  2.80it/s]Loading checkpoint shards:  82%|████████▏ | 27/33 [00:12<00:02,  2.74it/s]Loading checkpoint shards:  88%|████████▊ | 29/33 [00:12<00:01,  2.88it/s]Loading checkpoint shards:  88%|████████▊ | 29/33 [00:13<00:01,  2.77it/s]Loading checkpoint shards:  97%|█████████▋| 32/33 [00:13<00:00,  2.80it/s]Loading checkpoint shards:  85%|████████▍ | 28/33 [00:12<00:01,  2.66it/s]Loading checkpoint shards:  91%|█████████ | 30/33 [00:12<00:01,  2.92it/s][2023-04-21 10:46:18,896] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2986970
[2023-04-21 10:46:18,896] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2986972
Loading checkpoint shards:  91%|█████████ | 30/33 [00:13<00:01,  2.80it/s][2023-04-21 10:46:19,057] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2986973
[2023-04-21 10:46:19,219] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2986975
Loading checkpoint shards:  94%|█████████▍| 31/33 [00:13<00:00,  2.91it/s][2023-04-21 10:46:19,422] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2986977
[2023-04-21 10:46:19,581] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2986978
[2023-04-21 10:46:19,740] [ERROR] [launch.py:434:sigkill_handler] ['/home/ckq/anaconda3/envs/accel/bin/python3.9', '-u', 'finetune.py', '--local_rank=5', '--base_model', '/home/ckq/CHATGPT/0model_pretrained/llama-7b-hf', '--data_path', 'yahma/alpaca-cleaned', '--output_dir', './lora-alpaca', '--batch_size', '32', '--micro_batch_size', '8', '--num_epochs', '2', '--learning_rate', '3e-4', '--cutoff_len', '1024', '--val_set_size', '2000', '--lora_r', '8', '--lora_alpha', '16', '--lora_dropout', '0.05', '--lora_target_modules', '[q_proj,v_proj]', '--train_on_inputs', '--resume_from_checkpoint', '', '--deepspeed_path', '/home/ckq/CHATGPT/alpaca-lora/config/6_gpu_ft.yaml', '--group_by_length', '--wandb_project', 'llama-lora'] exits with return code = 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
Emitting ninja build file /home/ckq/.cache/torch_extensions/py39_cu117/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 0.2746460437774658 seconds
Loading extension module utils...
Time to load utils op: 0.3052031993865967 seconds
Loading extension module utils...
Time to load utils op: 0.3050665855407715 seconds
Loading extension module utils...
Time to load utils op: 0.3058037757873535 seconds
Loading extension module utils...
Loading extension module utils...
Time to load utils op: 0.3056964874267578 seconds
Time to load utils op: 0.3055307865142822 seconds
Rank: 0 partition count [6] and sizes[(699052, False)] 
Rank: 4 partition count [6] and sizes[(699052, False)] 
Rank: 2 partition count [6] and sizes[(699052, False)] 
Rank: 3 partition count [6] and sizes[(699052, False)] 
Rank: 5 partition count [6] and sizes[(699052, False)] 
Rank: 1 partition count [6] and sizes[(699052, False)] 
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...No modifications detected for re-loaded extension module utils, skipping build step...

Loading extension module utils...
Time to load utils op: 0.0003719329833984375 seconds
No modifications detected for re-loaded extension module utils, skipping build step...
Loading extension module utils...
Time to load utils op: 0.0003077983856201172 seconds
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...

No modifications detected for re-loaded extension module utils, skipping build step...
No modifications detected for re-loaded extension module utils, skipping build step...Loading extension module utils...

Loading extension module utils...
Time to load utils op: 0.0003151893615722656 seconds
Time to load utils op: 0.00032520294189453125 seconds
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
No modifications detected for re-loaded extension module utils, skipping build step...
Loading extension module utils...
Time to load utils op: 0.0003027915954589844 seconds
Using /home/ckq/.cache/torch_extensions/py39_cu117 as PyTorch extensions root...
No modifications detected for re-loaded extension module utils, skipping build step...
Loading extension module utils...
Time to load utils op: 0.00038623809814453125 seconds
wandb: Currently logged in as: qiker. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.0
wandb: Run data is saved locally in /home/ckq/CHATGPT/alpaca-lora/wandb/run-20230421_104555-yhbuweb1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-bee-1
wandb: ⭐️ View project at https://wandb.ai/qiker/llama-lora
wandb: 🚀 View run at https://wandb.ai/qiker/llama-lora/runs/yhbuweb1
  0%|          | 0/518 [00:00<?, ?it/s]  0%|          | 1/518 [00:16<2:25:55, 16.93s/it]  0%|          | 2/518 [00:26<1:48:40, 12.64s/it]  1%|          | 3/518 [00:34<1:29:03, 10.38s/it]  1%|          | 4/518 [00:40<1:14:25,  8.69s/it]  1%|          | 5/518 [00:45<1:02:33,  7.32s/it]  1%|          | 6/518 [00:49<52:51,  6.19s/it]    1%|▏         | 7/518 [00:52<45:01,  5.29s/it]  2%|▏         | 8/518 [00:55<39:01,  4.59s/it]  2%|▏         | 9/518 [01:07<59:10,  6.98s/it]  2%|▏         | 10/518 [01:18<1:07:57,  8.03s/it]                                                  {'loss': 1.8524, 'learning_rate': 0.00014999999999999996, 'epoch': 0.04}
  2%|▏         | 10/518 [01:18<1:07:57,  8.03s/it]  2%|▏         | 11/518 [01:26<1:08:43,  8.13s/it]  2%|▏         | 12/518 [01:33<1:04:56,  7.70s/it]  3%|▎         | 13/518 [01:38<58:53,  7.00s/it]    3%|▎         | 14/518 [01:43<52:03,  6.20s/it]  3%|▎         | 15/518 [01:46<45:26,  5.42s/it]  3%|▎         | 16/518 [01:49<39:44,  4.75s/it]  3%|▎         | 17/518 [02:00<53:38,  6.42s/it]  3%|▎         | 18/518 [02:11<1:06:15,  7.95s/it]  4%|▎         | 19/518 [02:20<1:08:53,  8.28s/it]  4%|▍         | 20/518 [02:28<1:06:01,  7.96s/it]                                                  {'loss': 1.5594, 'learning_rate': 0.00019515449934959714, 'epoch': 0.08}
  4%|▍         | 20/518 [02:28<1:06:01,  7.96s/it]  4%|▍         | 21/518 [02:33<1:00:20,  7.28s/it]  4%|▍         | 22/518 [02:38<53:47,  6.51s/it]    4%|▍         | 23/518 [02:42<47:11,  5.72s/it]  5%|▍         | 24/518 [02:45<41:16,  5.01s/it]  5%|▍         | 25/518 [02:48<36:25,  4.43s/it]  5%|▌         | 26/518 [03:03<1:01:24,  7.49s/it]  5%|▌         | 27/518 [03:13<1:06:44,  8.16s/it]  5%|▌         | 28/518 [03:20<1:05:42,  8.05s/it]  6%|▌         | 29/518 [03:27<1:00:53,  7.47s/it]  6%|▌         | 30/518 [03:32<54:38,  6.72s/it]                                                  {'loss': 1.2701, 'learning_rate': 0.0002215681882079493, 'epoch': 0.12}
  6%|▌         | 30/518 [03:32<54:38,  6.72s/it]  6%|▌         | 31/518 [03:36<47:54,  5.90s/it]  6%|▌         | 32/518 [03:39<41:51,  5.17s/it]  6%|▋         | 33/518 [03:42<36:53,  4.56s/it]  7%|▋         | 34/518 [03:54<55:32,  6.89s/it]  7%|▋         | 35/518 [04:05<1:04:13,  7.98s/it]  7%|▋         | 36/518 [04:13<1:05:21,  8.14s/it]  7%|▋         | 37/518 [04:20<1:01:45,  7.70s/it]  7%|▋         | 38/518 [04:25<55:50,  6.98s/it]    8%|▊         | 39/518 [04:30<49:23,  6.19s/it]  8%|▊         | 40/518 [04:33<43:16,  5.43s/it]                                                {'loss': 1.2216, 'learning_rate': 0.00024030899869919428, 'epoch': 0.15}
  8%|▊         | 40/518 [04:33<43:16,  5.43s/it]  8%|▊         | 41/518 [04:37<38:01,  4.78s/it]  8%|▊         | 42/518 [04:47<51:36,  6.50s/it]  8%|▊         | 43/518 [04:59<1:04:12,  8.11s/it]  8%|▊         | 44/518 [05:08<1:06:27,  8.41s/it]  9%|▊         | 45/518 [05:16<1:04:04,  8.13s/it]  9%|▉         | 46/518 [05:21<58:24,  7.42s/it]    9%|▉         | 47/518 [05:26<51:44,  6.59s/it]  9%|▉         | 48/518 [05:30<45:08,  5.76s/it]  9%|▉         | 49/518 [05:33<39:32,  5.06s/it] 10%|▉         | 50/518 [05:36<34:55,  4.48s/it]                                                {'loss': 1.3414, 'learning_rate': 0.00025484550065040277, 'epoch': 0.19}
 10%|▉         | 50/518 [05:36<34:55,  4.48s/it] 10%|▉         | 51/518 [05:50<56:37,  7.27s/it] 10%|█         | 52/518 [06:00<1:02:17,  8.02s/it] 10%|█         | 53/518 [06:08<1:02:02,  8.01s/it] 10%|█         | 54/518 [06:14<57:34,  7.44s/it]   11%|█         | 55/518 [06:19<51:43,  6.70s/it] 11%|█         | 56/518 [06:23<45:28,  5.91s/it] 11%|█         | 57/518 [06:27<39:54,  5.20s/it] 11%|█         | 58/518 [06:30<35:17,  4.60s/it] 11%|█▏        | 59/518 [06:43<54:13,  7.09s/it] 12%|█▏        | 60/518 [06:54<1:02:48,  8.23s/it]                                                  {'loss': 1.5196, 'learning_rate': 0.00026672268755754643, 'epoch': 0.23}
 12%|█▏        | 60/518 [06:54<1:02:48,  8.23s/it] 12%|█▏        | 61/518 [07:02<1:03:28,  8.33s/it] 12%|█▏        | 62/518 [07:09<59:41,  7.85s/it]   12%|█▏        | 63/518 [07:14<54:05,  7.13s/it] 12%|█▏        | 64/518 [07:19<47:44,  6.31s/it] 13%|█▎        | 65/518 [07:23<41:40,  5.52s/it] 13%|█▎        | 66/518 [07:26<36:28,  4.84s/it] 13%|█▎        | 67/518 [07:38<52:42,  7.01s/it] 13%|█▎        | 68/518 [07:49<1:02:30,  8.33s/it] 13%|█▎        | 69/518 [07:58<1:03:53,  8.54s/it] 14%|█▎        | 70/518 [08:05<1:00:30,  8.10s/it]                                                  {'loss': 2.3765, 'learning_rate': 0.00027676470600213846, 'epoch': 0.27}
 14%|█▎        | 70/518 [08:05<1:00:30,  8.10s/it] 14%|█▎        | 71/518 [08:11<54:51,  7.36s/it]   14%|█▍        | 72/518 [08:16<48:33,  6.53s/it] 14%|█▍        | 73/518 [08:19<42:21,  5.71s/it] 14%|█▍        | 74/518 [08:23<37:01,  5.00s/it] 14%|█▍        | 75/518 [08:26<32:33,  4.41s/it] 15%|█▍        | 76/518 [08:40<53:39,  7.28s/it] 15%|█▍        | 77/518 [08:49<58:53,  8.01s/it] 15%|█▌        | 78/518 [08:57<58:32,  7.98s/it] 15%|█▌        | 79/518 [09:04<54:30,  7.45s/it] 15%|█▌        | 80/518 [09:09<49:07,  6.73s/it]                                                {'loss': 5.0615, 'learning_rate': 0.00028546349804879146, 'epoch': 0.31}
 15%|█▌        | 80/518 [09:09<49:07,  6.73s/it] 16%|█▌        | 81/518 [09:13<43:07,  5.92s/it] 16%|█▌        | 82/518 [09:16<37:33,  5.17s/it] 16%|█▌        | 83/518 [09:19<32:55,  4.54s/it] 16%|█▌        | 84/518 [09:32<50:29,  6.98s/it] 16%|█▋        | 85/518 [09:43<58:22,  8.09s/it] 17%|█▋        | 86/518 [09:51<59:04,  8.21s/it] 17%|█▋        | 87/518 [09:58<55:42,  7.76s/it] 17%|█▋        | 88/518 [10:03<50:18,  7.02s/it] 17%|█▋        | 89/518 [10:07<44:25,  6.21s/it] 17%|█▋        | 90/518 [10:11<38:41,  5.42s/it]                                                {'loss': 6.5513, 'learning_rate': 0.00029313637641589866, 'epoch': 0.35}
 17%|█▋        | 90/518 [10:11<38:41,  5.42s/it] 18%|█▊        | 91/518 [10:14<33:41,  4.73s/it] 18%|█▊        | 92/518 [10:24<44:50,  6.32s/it] 18%|█▊        | 93/518 [10:36<55:40,  7.86s/it] 18%|█▊        | 94/518 [10:45<58:08,  8.23s/it] 18%|█▊        | 95/518 [10:52<55:53,  7.93s/it] 19%|█▊        | 96/518 [10:58<51:03,  7.26s/it] 19%|█▊        | 97/518 [11:02<45:14,  6.45s/it] 19%|█▉        | 98/518 [11:06<39:30,  5.64s/it] 19%|█▉        | 99/518 [11:09<34:21,  4.92s/it] 19%|█▉        | 100/518 [11:12<30:04,  4.32s/it]                                                 {'loss': 6.7441, 'learning_rate': 0.0002999999999999999, 'epoch': 0.39}
 19%|█▉        | 100/518 [11:12<30:04,  4.32s/it] 19%|█▉        | 101/518 [11:26<49:29,  7.12s/it] 20%|█▉        | 102/518 [11:35<54:52,  7.92s/it] 20%|█▉        | 103/518 [11:43<54:23,  7.86s/it] 20%|██        | 104/518 [11:49<50:24,  7.30s/it] 20%|██        | 105/518 [11:54<45:17,  6.58s/it] 20%|██        | 106/518 [11:58<39:42,  5.78s/it] 21%|██        | 107/518 [12:01<34:40,  5.06s/it] 21%|██        | 108/518 [12:04<30:19,  4.44s/it] 21%|██        | 109/518 [12:17<46:31,  6.82s/it] 21%|██        | 110/518 [12:27<53:54,  7.93s/it]                                                 {'loss': 7.0502, 'learning_rate': 0.0002935406698564593, 'epoch': 0.42}
 21%|██        | 110/518 [12:27<53:54,  7.93s/it] 21%|██▏       | 111/518 [12:36<54:39,  8.06s/it] 22%|██▏       | 112/518 [12:42<51:24,  7.60s/it] 22%|██▏       | 113/518 [12:47<46:29,  6.89s/it] 22%|██▏       | 114/518 [12:52<41:04,  6.10s/it] 22%|██▏       | 115/518 [12:55<35:53,  5.34s/it] 22%|██▏       | 116/518 [12:58<31:23,  4.68s/it] 23%|██▎       | 117/518 [13:09<42:20,  6.33s/it] 23%|██▎       | 118/518 [13:20<52:37,  7.89s/it] 23%|██▎       | 119/518 [13:29<54:25,  8.18s/it] 23%|██▎       | 120/518 [13:36<52:09,  7.86s/it]                                                 {'loss': 7.0283, 'learning_rate': 0.00028636363636363636, 'epoch': 0.46}
 23%|██▎       | 120/518 [13:36<52:09,  7.86s/it] 23%|██▎       | 121/518 [13:42<47:22,  7.16s/it] 24%|██▎       | 122/518 [13:46<42:09,  6.39s/it] 24%|██▎       | 123/518 [13:50<36:49,  5.59s/it] 24%|██▍       | 124/518 [13:53<32:00,  4.88s/it] 24%|██▍       | 125/518 [13:56<28:03,  4.28s/it] 24%|██▍       | 126/518 [14:10<46:19,  7.09s/it] 25%|██▍       | 127/518 [14:19<51:11,  7.85s/it] 25%|██▍       | 128/518 [14:27<50:43,  7.80s/it] 25%|██▍       | 129/518 [14:33<47:11,  7.28s/it] 25%|██▌       | 130/518 [14:38<42:24,  6.56s/it]                                                 {'loss': 6.9278, 'learning_rate': 0.0002791866028708134, 'epoch': 0.5}
 25%|██▌       | 130/518 [14:38<42:24,  6.56s/it] 25%|██▌       | 131/518 [14:42<37:10,  5.76s/it] 25%|██▌       | 132/518 [14:45<32:19,  5.02s/it] 26%|██▌       | 133/518 [14:48<28:16,  4.41s/it] 26%|██▌       | 134/518 [15:01<44:18,  6.92s/it] 26%|██▌       | 135/518 [15:11<50:50,  7.97s/it] 26%|██▋       | 136/518 [15:20<51:23,  8.07s/it] 26%|██▋       | 137/518 [15:26<48:21,  7.62s/it] 27%|██▋       | 138/518 [15:31<43:39,  6.89s/it] 27%|██▋       | 139/518 [15:36<38:27,  6.09s/it] 27%|██▋       | 140/518 [15:39<33:33,  5.33s/it]                                                 {'loss': 6.8408, 'learning_rate': 0.0002720095693779904, 'epoch': 0.54}
 27%|██▋       | 140/518 [15:39<33:33,  5.33s/it] 27%|██▋       | 141/518 [15:42<29:13,  4.65s/it] 27%|██▋       | 142/518 [15:53<40:20,  6.44s/it] 28%|██▊       | 143/518 [16:04<49:44,  7.96s/it] 28%|██▊       | 144/518 [16:13<51:31,  8.27s/it] 28%|██▊       | 145/518 [16:20<49:23,  7.94s/it] 28%|██▊       | 146/518 [16:26<44:57,  7.25s/it] 28%|██▊       | 147/518 [16:31<39:46,  6.43s/it] 29%|██▊       | 148/518 [16:34<34:43,  5.63s/it] 29%|██▉       | 149/518 [16:38<30:09,  4.90s/it] 29%|██▉       | 150/518 [16:40<26:22,  4.30s/it]                                                 {'loss': 6.7844, 'learning_rate': 0.00026483253588516746, 'epoch': 0.58}
 29%|██▉       | 150/518 [16:40<26:22,  4.30s/it] 29%|██▉       | 151/518 [16:55<45:42,  7.47s/it] 29%|██▉       | 152/518 [17:05<49:22,  8.09s/it] 30%|██▉       | 153/518 [17:13<48:19,  7.94s/it] 30%|██▉       | 154/518 [17:19<44:49,  7.39s/it] 30%|██▉       | 155/518 [17:23<40:04,  6.63s/it] 30%|███       | 156/518 [17:27<35:02,  5.81s/it] 30%|███       | 157/518 [17:31<30:27,  5.06s/it] 31%|███       | 158/518 [17:34<26:45,  4.46s/it] 31%|███       | 159/518 [17:46<41:27,  6.93s/it] 31%|███       | 160/518 [17:57<48:24,  8.11s/it]                                                 {'loss': 7.0639, 'learning_rate': 0.0002576555023923445, 'epoch': 0.62}
 31%|███       | 160/518 [17:57<48:24,  8.11s/it] 31%|███       | 161/518 [18:06<49:03,  8.25s/it] 31%|███▏      | 162/518 [18:12<46:06,  7.77s/it] 31%|███▏      | 163/518 [18:18<41:39,  7.04s/it] 32%|███▏      | 164/518 [18:22<36:32,  6.19s/it] 32%|███▏      | 165/518 [18:26<31:50,  5.41s/it] 32%|███▏      | 166/518 [18:29<27:43,  4.73s/it] 32%|███▏      | 167/518 [18:39<37:58,  6.49s/it] 32%|███▏      | 168/518 [18:51<47:01,  8.06s/it] 33%|███▎      | 169/518 [19:00<48:44,  8.38s/it] 33%|███▎      | 170/518 [19:08<46:41,  8.05s/it]                                                 {'loss': 7.0701, 'learning_rate': 0.0002504784688995215, 'epoch': 0.66}
 33%|███▎      | 170/518 [19:08<46:41,  8.05s/it][2023-04-21 11:05:20,628] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2983799
[2023-04-21 11:05:20,628] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2983801
[2023-04-21 11:05:20,908] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2983803
[2023-04-21 11:05:21,226] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2983804
[2023-04-21 11:05:21,544] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2983805
[2023-04-21 11:05:21,822] [INFO] [launch.py:428:sigkill_handler] Killing subprocess 2983806
[2023-04-21 11:05:22,222] [ERROR] [launch.py:434:sigkill_handler] ['/home/ckq/anaconda3/envs/accel/bin/python3.9', '-u', 'finetune.py', '--local_rank=5', '--base_model', '/home/ckq/CHATGPT/0model_pretrained/llama-7b-hf', '--data_path', 'yahma/alpaca-cleaned', '--output_dir', './lora-alpaca', '--batch_size', '32', '--micro_batch_size', '8', '--num_epochs', '2', '--learning_rate', '3e-4', '--cutoff_len', '1024', '--val_set_size', '2000', '--lora_r', '8', '--lora_alpha', '16', '--lora_dropout', '0.05', '--lora_target_modules', '[q_proj,v_proj]', '--train_on_inputs', '--resume_from_checkpoint', '', '--deepspeed_path', '/home/ckq/CHATGPT/alpaca-lora/config/6_gpu_ft.yaml', '--group_by_length', '--wandb_project', 'llama-lora'] exits with return code = -9
